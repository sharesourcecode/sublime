#!/bin/bash
COLOR_YELLOW='\e[00;33m\e[01;07m'
COLOR_RESET='\e[00m'
echo -e "${COLOR_YELLOW}Se ap√≥s 30 segundos nada for digitado, segue as op√ß√µes padr√µes.${COLOR_RESET}"
read -p "Link de acesso: " -t 30 -r URL
if [[ -z $URL ]]; then
    # Link de acesso padr√£o
    URL='ifconfig.me'
fi
read -p "Tempo de acesso em segundos: " -t 30 -r -n 2 AT
if [[ -z $AT ]]; then
    # Tempo de acesso padr√£o
    AT=6
fi
# Seta o diret√≥rio de trabalho
DIR="$HOME/sublime/"
# Entra no diret√≥rio
cd $DIR
# Busca fun√ß√µes em outros arquivos no diret√≥rio.
# Conhecido como source üòí
. timeexit.sh
# Consta o total de linhas em proxy.txt
LINHASTOTAL=$(cat proxy.txt | wc -l)
echo -e "${COLOR_YELLOW}N√∫mero total de linhas no arquivo: ${LINHASTOTAL}${COLOR_RESET}"
sleep 5s
# Loop de contagem regressiva do total de linhas
# at√© 1
for num in `seq $LINHASTOTAL -1 1`;
        do
    # Pega o proxy da linha atual.
    ATUALPROXY=$(cat proxy.txt | tail -n $LINHASTOTAL | head -n 1)
    # Sorteia um UA na lista em base64
    echo "TW96aWxsYS81LjAgKExpbnV4OyBVOyBBbmRyb2lkIDIuMikgQXBwbGVXZWJLaXQvNTMzLjEgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBNb2JpbGUgU2FmYXJpLzUzMy4xCk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjIuMTsgZW4tdXM7IE5leHVzIDUgQnVpbGQvSk9QNDBEKSBBcHBsZVdlYktpdC81MzUuMTkgKEtIVE1MLCBsaWtlIEdlY2tvOyBnb29nbGV3ZWJsaWdodCkgQ2hyb21lLzM4LjAuMTAyNS4xNjYgTW9iaWxlIFNhZmFyaS81MzUuMTkKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDYuMC4xOyBSZWRNaSBOb3RlIDUgQnVpbGQvUkIzTjVDOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzY4LjAuMzQ0MC45MSBNb2JpbGUgU2FmYXJpLzUzNy4zNgpNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNy4xLjI7IEFGVE1NIEJ1aWxkL05TNjI2NTsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS83MC4wLjM1MzguMTEwIE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA2LjA7IExHLUg2MzEgQnVpbGQvTVJBNThLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvMzguMC4yMTI1LjEwMiBNb2JpbGUgU2FmYXJpLzUzNy4zNgpNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNy4xLjI7IEFGVE1NIEJ1aWxkL05TNjI2NDsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS81OS4wLjMwNzEuMTI1IE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA5OyBTTS1HOTYwRiBCdWlsZC9QUFIxLjE4MDYxMC4wMTE7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvNzQuMC4zNzI5LjE1NyBNb2JpbGUgU2FmYXJpLzUzNy4zNgpNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNy4wOyBTTS1HODkyQSBCdWlsZC9OUkQ5ME07IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvNjguMC4zNDQwLjE4MDUgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDYuMC4xOyBTTS1HNTMyRyBCdWlsZC9NTUIyOVQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS82My4wLjMyMzkuODMgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDk7IFNNLUc5NTBGIEJ1aWxkL1BQUjEuMTgwNjEwLjAxMTsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS83NC4wLjM3MjkuMTU3IE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA1LjEuMTsgTmF2b3JpIFFMIFN0aXggMzUwMCBCdWlsZC9MTVk0OUY7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvNjcuMC4zMzk2Ljg3IFNhZmFyaS81MzcuMzYKRGFsdmlrLzIuMS4wIChMaW51eDsgVTsgQW5kcm9pZCA1LjEuMTsgTmF2b3JpIFFMIFN0aXggMzUwMCBCdWlsZC9MTVk0OUYpCk1vemlsbGEvNS4wIChBbmRyb2lkIDk7IE1vYmlsZTsgcnY6NjguMCkgR2Vja28vNjguMCBGaXJlZm94LzY4LjAKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDYuMDsgdml2byAxNzEzIEJ1aWxkL01SQTU4SykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzUzLjAuMjc4NS4xMjQgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDcuMS4xOyBTTS1UNTU1IEJ1aWxkL05NRjI2WDsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS84My4wLjQxMDMuOTYgU2FmYXJpLzUzNy4zNgpNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNy4wOyBTTS1HNjEwTSBCdWlsZC9OUkQ5ME0pIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS82OS4wLjM0OTcuMTAwIE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA3LjE7IE1pIEExIEJ1aWxkL04yRzQ3SCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzU4LjAuMzAyOS44MyBNb2JpbGUgU2FmYXJpLzUzNy4zNgpNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNy4wOyBTTS1HNTcwTSBCdWlsZC9OUkQ5ME0pIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS82OS4wLjM0OTcuMTAwIE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA4LjAuMDsgU00tRzkzMEYgQnVpbGQvUjE2Tlc7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvNzQuMC4zNzI5LjE1NyBNb2JpbGUgU2FmYXJpLzUzNy4zNgpNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNi4wOyBOZXh1cyA1IEJ1aWxkL01SQTU4TikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzY1LjAuMzMyNS4xODEgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDcuMS4yOyBEU0NTOSBCdWlsZC9OSEc0N0w7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvODAuMC4zOTg3LjE0OSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA5OyBTQU1TVU5HIFNNLUc5NjBVKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBTYW1zdW5nQnJvd3Nlci8xMC4yIENocm9tZS83MS4wLjM1NzguOTkgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDUuMTsgQTM3ZiBCdWlsZC9MTVk0N1YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS80My4wLjIzNTcuOTMgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBVOyBBbmRyb2lkIDQuMzsgZW4tdXM7IFNNLU45MDBUIEJ1aWxkL0pTUzE1SikgQXBwbGVXZWJLaXQvNTM0LjMwIChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgTW9iaWxlIFNhZmFyaS81MzQuMzAKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDk7IFNNLUc5NjVGIEJ1aWxkL1BQUjEuMTgwNjEwLjAxMTsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS83NC4wLjM3MjkuMTU3IE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA2LjAuMTsgU00tRzUzMk0gQnVpbGQvTU1CMjlUKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNjkuMC4zNDk3LjEwMCBNb2JpbGUgU2FmYXJpLzUzNy4zNgpNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNi4wLjE7IENQSDE2MDcgQnVpbGQvTU1CMjlNOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzYzLjAuMzIzOS4xMTEgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDUuMS4xOyBMZW5vdm8tQTYwMjBsMzYgQnVpbGQvTE1ZNDdWKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNDMuMC4yMzU3LjkzIE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMTsgU00tQTEwMlUpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84OS4wLjQzODkuNzIgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDYuMC4xOyB2aXZvIDE2MDMgQnVpbGQvTU1CMjlNKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNTguMC4zMDI5LjgzIE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA3LjEuMjsgdml2byB5MzUgQnVpbGQvTjJHNDhCOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzY2LjAuMzM1OS4xNTggTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDYuMC4xOyBMZW5vdm8tQTYwMjBsMzYgQnVpbGQvTU1CMjlNKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNDMuMC4yMzU3LjkzIE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA2LjAuMTsgUmVkbWkgNEEgQnVpbGQvTU1CMjlNOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzYwLjAuMzExMi4xMTYgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDk7IFNBTVNVTkcgU00tRzk2MFUpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFNhbXN1bmdCcm93c2VyLzEwLjEgQ2hyb21lLzcxLjAuMzU3OC45OSBNb2JpbGUgU2FmYXJpLzUzNy4zNgpNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNi4wLjE7IFNNLUo3MDBNIEJ1aWxkL01NQjI5SykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzY5LjAuMzQ5Ny4xMDAgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBVOyBBbmRyb2lkIDYuMC4xOyB6aC1DTjsgRjUxMjEgQnVpbGQvMzQuMC5BLjEuMjQ3KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvNDAuMC4yMjE0Ljg5IFVDQnJvd3Nlci8xMS41LjEuOTQ0IE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA5OyBTQU1TVU5HIFNNLUc5NTBVKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBTYW1zdW5nQnJvd3Nlci8xMC4yIENocm9tZS83MS4wLjM1NzguOTkgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBVOyBBbmRyb2lkIDIuMi4xOyBlbi11czsgTmV4dXMgT25lIEJ1aWxkL0ZSRzgzKSBBcHBsZVdlYktpdC81MzMuMSAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIE1vYmlsZSBTYWZhcmkvNTMzLjEKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDcuMDsgU00tRzU3ME0gQnVpbGQvTlJEOTBNKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNjcuMC4zMzk2Ljg3IE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA2LjA7IHZpdm8gMTYwNiBCdWlsZC9NTUIyOU0pIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS81My4wLjI3ODUuMTI0IE1vYmlsZSBTYWZhcmkvNTM3LjM2Ck1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgQW5kcm9pZCBTREsgYnVpbHQgZm9yIHg4NikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzkxLjAuNDQ3Mi4xMjAgTW9iaWxlIFNhZmFyaS81MzcuMzYKTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDk7IFNNLUExMDJVKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNzQuMC4zNzI5LjEzNiBNb2JpbGUgU2FmYXJpLzUzNy4zNgpEYWx2aWsvMi4xLjAgKExpbnV4OyBVOyBBbmRyb2lkIDcuMS4yOyBBRlRBIEJ1aWxkL05TNjI2NCkgQ1RWCg==" | base64 -d | tail -n 1 >${DIR}.ua
    DEC=$AT
    for num in `seq $AT -1 1`;
    do
       sleep 1s
        echo -e "${COLOR_YELLOW}${DEC}/${AT} - Proxy: ${ATUALPROXY}${COLOR_RESET}"
        # Acessa o link com proxy e um UA aleat√≥rio
        ( w3m -dump -o gopher_proxy="${ATUALPROXY}:443" $URL -o user_agent="$(shuf -n1 ${DIR}.ua)" ) &
        # Aguarda o processo anterior por 30s,
        # se n√£o foi conclu√≠do mata o mesmo.
        _timeexit 30
       DEC=$[$DEC-1]
    done
    # Aguarda o susposto tempo de acesso.
#    sleep $AT
    # Limpa a tela
    clear
    # Decrementa o total de linhas
    LINHASTOTAL=$[$LINHASTOTAL-1]
done
